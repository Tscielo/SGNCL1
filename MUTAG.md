# SGNCL
Contrastive Learning based on Subgraph Network for Graph Classification

## 数据集MUTAG
### 1.无采样实验
#### 一阶子图网络VS原始网络
##### 设置1（早停法设置参数：10，epoch：500）

数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | epoch | val_acc  | test_acc | loss     |
| ---- | ----- | -------- | -------- | -------- |
| 0    | 314   | 0.898830 | 0.913743 | 3.776610 |
| 1    | 322   | 0.861696 | 0.883333 | 3.680645 |
| 2    | 311   | 0.926316 | 0.904094 | 4.049884 |
| 3    | 324   | 0.915205 | 0.876608 | 3.316971 |
| 4    | 320   | 0.866082 | 0.899415 | 3.536701 |

平均精度：0.89544
#### 设置2（早停法设置参数：10，epoch：300）

数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：300

网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC

结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 300        | 0.898830 | 0.903216 | 3.709574 |
| 1    | 300        | 0.893860 | 0.898246 | 3.669484 |
| 2    | 300        | 0.904678 | 0.888596 | 4.019850 |
| 3    | 300        | 0.904094 | 0.888596 | 3.312721 |
| 4    | 300        | 0.871637 | 0.894152 | 3.561834 |

平均精度：0.89456
#### 二阶子图网络VS原始网络

#### 设置1（早停法设置参数：10，epoch：500）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | epoch | val_acc  | test_acc | loss     |
| ---- | ----- | -------- | -------- | -------- |
| 0    | 318   | 0.914912 | 0.908480 | 3.687959 |
| 1    | 311   | 0.839766 | 0.888596 | 3.467019 |
| 2    | 312   | 0.931579 | 0.893860 | 3.604391 |
| 3    | 311   | 0.909064 | 0.882164 | 3.543156 |
| 4    | 319   | 0.887719 | 0.899123 | 3.841913 |

平均精度：0.89444

#### 设置2（早停法设置参数：10，epoch：300）

数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500

网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC

结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 300        | 0.914620 | 0.925146 | 3.677318 |
| 1    | 300        | 0.888596 | 0.893275 | 3.444137 |
| 2    | 300        | 0.909649 | 0.904094 | 3.618716 |
| 3    | 300        | 0.877485 | 0.883333 | 3.532901 |
| 4    | 300        | 0.887719 | 0.894152 | 3.723847 |

平均精度：0.90

### 一阶子图网络与原始网络表示结合（取平均）VS原始网络


#### 设置1（早停法设置参数：10，epoch：500）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 312        | 0.888596 | 0.892690 | 3.012356 |
| 1    | 312        | 0.850877 | 0.888304 | 2.810749 |
| 2    | 323        | 0.873099 | 0.893860 | 2.825299 |
| 3    | 319        | 0.887719 | 0.881871 | 2.545746 |
| 4    | 328        | 0.909942 | 0.888889 | 2.799377 |

平均精度：0.88912

#### 设置2（早停法设置参数：10，epoch：300）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 300        | 0.877778 | 0.892690 | 3.030140 |
| 1    | 300        | 0.862281 | 0.903801 | 2.767945 |
| 2    | 300        | 0.888012 | 0.893567 | 2.831132 |
| 3    | 300        | 0.887719 | 0.904386 | 2.511981 |
| 4    | 300        | 0.887719 | 0.904678 | 2.807043 |

平均精度：0.899825

### 一阶子图网络、二阶子图网络与原始网络表示结合（取平均）VS原始网络


#### 设置1（早停法设置参数：10，epoch：500）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 334        | 0.898246 | 0.893860 | 2.936263 |
| 1    | 322        | 0.840058 | 0.877778 | 2.669537 |
| 2    | 340        | 0.888304 | 0.909942 | 3.129323 |
| 3    | 313        | 0.914327 | 0.887427 | 3.011163 |
| 4    | 323        | 0.893567 | 0.893567 | 2.767623 |

平均精度：0.88608

#### 设置2（早停法设置参数：10，epoch：300）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 300        | 0.877485 | 0.892690 | 2.903571 |
| 1    | 300        | 0.878363 | 0.871637 | 2.649354 |
| 2    | 300        | 0.909942 | 0.909649 | 3.116510 |
| 3    | 300        | 0.893275 | 0.904386 | 3.007054 |
| 4    | 300        | 0.876901 | 0.894152 | 2.803523 |

平均精度：0.89415

### 一阶子图网络、二阶子图网络结合（取平均）VS原始网络
![image](https://user-images.githubusercontent.com/107790262/174485910-109df0c0-0312-4599-bc0a-616c7fcdde6d.png)

#### 设置1（早停法设置参数：10，epoch：500）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 318        | 0.898830 | 0.897661 | 3.569906 |
| 1    | 328        | 0.861404 | 0.883333 | 3.640663 |
| 2    | 319        | 0.915789 | 0.883041 | 3.660745 |
| 3    | 330        | 0.936257 | 0.903216 | 3.621538 |
| 4    | 318        | 0.871930 | 0.883041 | 3.605444 |

平均精度：0.89006

#### 设置2（早停法设置参数：10，epoch：300）
数据集：MUTAG，基本模型：GINConv，激活函数：relu，子图模式：一阶子图网络，隐藏层维度：32，设置EPOCH：500
网络层数：4，学习率：0.001，tau：0.2，随机种子：[0,1,2,3,4]，batch_size：64，分类器：SVC
结果分析：十折交叉验证

| seed | stop_epoch | val_acc  | test_acc | loss     |
| ---- | ---------- | -------- | -------- | -------- |
| 0    | 300        | 0.925146 | 0.882164 | 3.506707 |
| 1    | 300        | 0.893860 | 0.882164 | 3.591992 |
| 2    | 300        | 0.899123 | 0.882749 | 3.624970 |
| 3    | 300        | 0.882749 | 0.899123 | 3.532720 |
| 4    | 300        | 0.866374 | 0.899415 | 3.654405 |

平均精度：0.88912

### 精度总结

|          | SGN1 vs SGN0 | SGN2 vs SGN0 | SGN0+1 vs SGN0 | SGN0+1+2 vs SGN0 | SGN1+2 vs SGN0 |
| -------- | ------------ | ------------ | -------------- | ---------------- | -------------- |
| epoch500 | **0.89544**  | 0.89444      | 0.88912        | 0.88608          | 0.89006        |
| epoch300 | 0.89456      | **0.90**     | 0.89983        | 0.89415          | 0.88912        |

## 2.采样网络

#### 基于度中心性采样 VS 随机采样 （epoch 500，SGN 1）

| Drop edge rate | Drop feature rate | ACC_Degree  | ACC_Random  |
| -------------- | ----------------- | ----------- | ----------- |
| 0.1            | 0.1               | 0.89561     | **0.89556** |
| 0.1            | 0.3               | **0.89690** | 0.88760     |
| 0.1            | 0.5               | 0.88368     | 0.89170     |
| 0.1            | 0.7               | 0.88275     | 0.89170     |

#### 基于度中心性采样 VS 随机采样 （epoch 500，SGN 2）

| Drop edge rate | Drop feature rate | ACC_Degree  | ACC_Random  |
| -------------- | ----------------- | ----------- | ----------- |
| 0.1            | 0.1               | **0.89678** | **0.90211** |
| 0.1            | 0.3               | 0.89678     | 0.88199     |
| 0.1            | 0.5               | 0.89257     | 0.89550     |
| 0.1            | 0.7               | 0.89035     | 0.90012     |

